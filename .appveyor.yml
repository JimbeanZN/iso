version: 1.0.0.{build}
configuration: Release

image: Visual Studio 2017

pull_requests:
  do_not_increment_build_number: true

nuget:
  disable_publish_on_pr: true

branches:
  only:
  - master

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'

before_build:
    - dotnet --version
    - dotnet restore ./src/Iso.Api/Iso.Api.csproj

build_script:
    - dotnet publish ./src/Iso.Api/Iso.Api.csproj --verbosity m --configuration Release --self-contained --runtime win-x64

artifacts:
    - path: '.\src\Iso.Api\bin\Release\netcoreapp2.1\win-x64\publish\'
      name: IsoPublished
      type: WebDeployPackage

deploy:
    - provider: Environment
      name: isodata
      on:
        branch: master
